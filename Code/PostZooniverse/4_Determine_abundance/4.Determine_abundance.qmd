---
title: "4. Determine abundance"
format: html
editor: visual
---

## Introduction
Once all of the consensus picks have been made for all of the subjects in a workflow, it is time to tie those subjects to the camera trap deployments they are associated with in order to develop relative abundance indices for each species at each location.

Let's set things up 

```{r, results = FALSE}
rm(list = ls())
library(tidyverse)
library(lubridate)
library(here)
```


The first step is to bind together all of the species determinations from a single workflow into a single data frame. This requires loading all of the files from the `Output/PostZooniverse/Consensus/By workflow/` folder for a particular workflow.

```{r}
Assigned <-read.csv(here("Output","PostZooniverse", "Consensus", "By workflow", "wfn16695_wfv29.1", "NoCoW_class-15-Feb-2024-wfn16695_wfv29.1_assigned.csv"))

Checked <- read.csv(here("Output","PostZooniverse", "Consensus", "By workflow", "wfn16695_wfv29.1", "NoCoW_class-15-Feb-2024-wfn16695_wfv29.1_checked.csv"))
                    
LastOnes <- read.csv(here("Output","PostZooniverse", "Consensus", "By workflow", "wfn16695_wfv29.1", "NoCoW_class-15-Feb-2024-wfn16695_wfv29.1_lastones.csv"))
```

All three follow the same format, so can join them together with rbind

```{r}
DF <- rbind(Assigned, Checked, LastOnes)
str(DF)
```
All of the image names begin with camera and sd card, so we can use that to make a new column of Cam_SD to match to the camera deployment sheet

```{r}
DF <- DF %>% mutate(
  Cam_SD = str_sub(Img1, 1,10))

#now move Cam_SD next to subject_ids


```


